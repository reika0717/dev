<html>
      <head>
        <meta charset="UTF-8">
        <title>sparql-proxy-README.md</title>
      </head>
      <body>
        <h1 id="sparql-proxy">sparql-proxy</h1>
<p>SPARQL-proxy is a portable Web application that works as a proxy server for any SPARQL endpoint providing the following functionalities:</p>
<ol>
<li>validation of the safety of query statements (omit SPARQL Update queries)</li>
<li>job scheduling for a large number of simultaneous SPARQL queries</li>
<li>providing a job management interface for time consuming SPARQL queries</li>
<li>(optional) cache mechanisms with compression for SPARQL results to improve response time</li>
<li>(optional) logging SPARQL queries and results</li>
<li>(experimental) splitting a SPARQL query into chunks by adding OFFSET &amp; LIMIT</li>
</ol>
<h2 id="docker">Docker</h2>
<pre><code>$ docker run -p 8080:3000 -e SPARQL_BACKEND=http://example.com/sparql dbcls/sparqlist
</code></pre><h2 id="prerequisites">Prerequisites</h2>
<ul>
<li><a href="https://nodejs.org/">Node.js</a></li>
</ul>
<h2 id="install">Install</h2>
<pre><code>$ git clone git@github.com:dbcls/sparql-proxy.git
$ cd sparql-proxy
$ npm install
</code></pre><p>(Be patient, <code>npm install</code> may take a few minutes)</p>
<h2 id="run">Run</h2>
<pre><code>$ PORT=3000 SPARQL_BACKEND=http://example.com/sparql ADMIN_USER=admin ADMIN_PASSWORD=password npm start
</code></pre><p>Open <code>http://localhost:3000/</code> on your browser.</p>
<p>Dashboard for administrators is at <code>http://localhost:3000/admin</code> .</p>
<h2 id="configuration">Configuration</h2>
<p>All configurations are done with environment variables.</p>
<h3 id="port"><code>PORT</code></h3>
<p>(default: <code>3000</code>)</p>
<p>Port to listen on.</p>
<h3 id="sparql_backend-required-"><code>SPARQL_BACKEND</code> (required)</h3>
<p>URL of the SPARQL backend.</p>
<h3 id="admin_user"><code>ADMIN_USER</code></h3>
<p>(default: <code>admin</code>)</p>
<p>User name for the sparql-proxy administrator.</p>
<h3 id="admin_password"><code>ADMIN_PASSWORD</code></h3>
<p>(default: <code>password</code>)</p>
<p>Password for the sparql-proxy administrator.</p>
<h3 id="cache_store"><code>CACHE_STORE</code></h3>
<p>(default: <code>null</code>)</p>
<p>Cache store. Specify one of the followings:</p>
<ul>
<li><code>null</code>: disable caching mechanism.</li>
<li><code>file</code>: cache in the local files.</li>
<li><code>memory</code>: cache in the proxy process.</li>
<li><code>redis</code>: use redis.</li>
<li><code>memcache</code>: use memcached.</li>
</ul>
<h3 id="compressor"><code>COMPRESSOR</code></h3>
<p>(default: <code>raw</code>)</p>
<p>Cache compression algorithm. Specify one of the followings:</p>
<ul>
<li><code>raw</code>: disable compression.</li>
<li><code>snappy</code>: use snappy.</li>
</ul>
<h3 id="cache_store_path"><code>CACHE_STORE_PATH</code></h3>
<p>(only applicable to <code>CACHE_STORE=file</code> case)
(default: <code>/tmp/sparql-proxy/cache</code>)</p>
<p>Root directory of the cache store.</p>
<h3 id="memory_max_entries"><code>MEMORY_MAX_ENTRIES</code></h3>
<p>(only applicable to <code>CACHE_STORE=memory</code> case)</p>
<p>Maximum number of the entries to keep in the cache.</p>
<h3 id="redis_url"><code>REDIS_URL</code></h3>
<p>(only applicable to <code>CACHE_STORE=redis</code> case)
(default: <code>localhost:6379</code>)</p>
<p>Specify URL to the redis server.</p>
<h2 id="memcache_servers"><code>MEMCACHE_SERVERS</code></h2>
<p>(only applicable to <code>CACHE_STORE=memcache</code> case)
(default: <code>localhost:11211</code>)</p>
<p>Specify server locations to the memcache servers (comma-separated).</p>
<h3 id="job_timeout"><code>JOB_TIMEOUT</code></h3>
<p>(default: <code>300000</code>)</p>
<p>Job timeout in millisecond.</p>
<h3 id="duration_to_keep_old_jobs"><code>DURATION_TO_KEEP_OLD_JOBS</code></h3>
<p>(default: <code>300000</code>)</p>
<p>Duration in millisecond to keep old jobs in the administrator dashboard.</p>
<h3 id="max_concurrency"><code>MAX_CONCURRENCY</code></h3>
<p>(default: <code>1</code>)</p>
<p>Number of the concurrent requests.</p>
<h3 id="max_waiting"><code>MAX_WAITING</code></h3>
<p>(default: <code>Infinity</code>)</p>
<p>Number of the jobs possible to be waiting.</p>
<h3 id="trust_proxy"><code>TRUST_PROXY</code></h3>
<p>(default: <code>false</code>)</p>
<p>Set <code>true</code> to trust proxies in front of the server.</p>
<h3 id="max_limit"><code>MAX_LIMIT</code></h3>
<p>(default: <code>10000</code>)</p>
<p>Cap the LIMIT of queries.</p>
<h3 id="enable_query_splitting"><code>ENABLE_QUERY_SPLITTING</code></h3>
<p>THIS IS AN EXPERIMENTAL FEATURE.</p>
<p>(default: <code>false</code>)</p>
<p>Set <code>true</code> to enable query splitting. If enabled, content negotiation will be disabled; spaql-proxy will always use <code>application/sparql-results+json</code>. That is because merging results other than JSON is not supported.</p>
<h3 id="max_chunk_limit"><code>MAX_CHUNK_LIMIT</code></h3>
<p>(only applicable to <code>ENABLE_QUERY_SPLITTING=true</code> case)
(default: <code>1000</code>)</p>
<p>Split queries into the chunk size specified.</p>
<h3 id="query_log_path"><code>QUERY_LOG_PATH</code></h3>
<p>(default: null)</p>
<p>Log queries (and the corresponding responses) to the file, if specified.</p>

      </body>
    </html>